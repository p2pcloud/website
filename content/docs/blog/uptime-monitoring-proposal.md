---
title: "Uptime monitoring litepaper"
weight: 1020
---

## Problem
Currently, there is no way to monitor the uptime of virtual machines. I propose adding sidecar virtual machines. Sidecar VMs will send pings to a central server (eventually a blockchain). By using data on virtual machine reservations and sidecar uptimes, we can obtain average uptime and incident counts for each hosting provider.

## Entities
**Sidecar** - a specialized virtual machine that the user launches alongside their primary virtual machine

**randomSidecarPubKey & randomSidecarPrivKey** - ed25519 private and public keys. Generated randomly at sidecar launch. The public key never leaves the sidecar.

**userSidecarPubKey & userSidecarPrivKey** - a random ed25519 key pair generated by the user, used for verifying sidecar launch validity. Not used elsewhere.

**Ping Server** - currently a centralized server managed by us; later a custom blockchain tailored for efficient ping storage.

## How does a user verify the sidecar public key?
The hosting provider returns the randomSidecarPubKey signed by the userSidecarPrivKey.

## How does the hosting provider verify the sidecar public key?
They make a GET request to the sidecar to obtain the randomSidecarPubKey.

## How does the ping server register the sidecar public key?
User registers randomSidecarPubKey verified by user's and hoster's signatures.

In case of a virtual machine and sidecar restart, the procedure starts over, and we notify the ping server again.

## Current Attestation Process
1. The hosting provider generates platform certificates and sends them to the user
1. The user verifies the certificates and issues a command to launch the VM
1. The hosting provider starts the virtual machine and takes a measurement
1. The user verifies the measurement and injects secrets

## Proposed Attestation Algorithm

1.  Launch and verify the sidecar
    1.  If the sidecar is already running, exit
    2.  The user generates userSidecarPrivKey
    3.  The user initiates the standard attestation procedure and injects userSidecarPrivKey and vmId as secrets
    4.  The hosting provider requests the public randomSidecarPubKey and vmId from the sidecar. Verifies the vmId correspondence. Now the hosting provider knows randomSidecarPubKey
    5.  The hosting provider requests the randomSidecarPubKey signed by userSidecarPrivKey from the sidecar and returns it to the user
    6.  The user decrypts the received data using userSidecarPrivKey. Now the user knows randomSidecarPubKey. If something is wrong, the launch is aborted
    7.  The hosting provider signs (vmId || randomSidecarPubKey) with their key, and the user signs with theirs. With this double signature, the public key is sent to the ping server
    8.  The ping server registers randomSidecarPubKey only if the user and hosting provider in the Broker smart contract correspond to the signatures.
    9.  The sidecar starts sending pings every 15 seconds to the ping server
2.  The launch proceeds as usual

## Issues with the Proposed Implementation

1.  Overhead costs for launching each virtual machine - 0.1 vCPU and 850 MB RAM. This is expensive.
2.  Virtual machine launch time will be significantly longer. Currently, it takes 90-120 seconds, but it could increase by 40-60 seconds. It might be possible to reduce this by parallelizing.
3.  A bug in the sidecar code may lower the hosting provider's rating.